@inherits LayoutComponentBase
@implements IAsyncDisposable

<HeadContent>
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" />
    <link rel="stylesheet" href="/css/renzoagostini.css" />
</HeadContent>

<div class="kc-body">
    <main class="kc-shell" role="main">
        <section class="kc-hero" aria-hidden="true">
            <div class="kc-hero-brand" aria-hidden="true">
                <img src="/img/logo.svg" alt="Renzo Agostini" />
            </div>
        </section>
        <section class="kc-panel">
            <header class="kc-panel-header">
                <h2>@HeaderTitle</h2>
            </header>
            @Body
        </section>
    </main>
</div>

@code {
    [Inject]
    private NavigationManager NavigationManager { get; set; } = default!;

    [Inject]
    private IJSRuntime JsRuntime { get; set; } = default!;

    private string HeaderTitle => IsRegisterRoute ? "Registrati" : "Accedi";

    private bool IsRegisterRoute => NavigationManager.Uri.Contains("/authentication/register", System.StringComparison.OrdinalIgnoreCase);

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            await JsRuntime.InvokeVoidAsync("document.body.classList.add", "kc-body");
        }
    }

    public async ValueTask DisposeAsync()
    {
        await JsRuntime.InvokeVoidAsync("document.body.classList.remove", "kc-body");
    }
}
